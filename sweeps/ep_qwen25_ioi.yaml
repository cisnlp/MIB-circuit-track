program: scripts/run_ep.py
project: mib-edge-pruning
name: ep-qwen25-ioi
metric:
  name: eval/sparse_performance
  goal: maximize

method: bayes
parameters:
  edge_learning_rate:
    values: [0.03, 0.4, 0.8]
  layer_learning_rate:
    values: [0.03, 0.4, 0.8]
  reg_edge_learning_rate:
    values: [0.001, 0.4, 0.8]
  reg_layer_learning_rate:
    values: [0.001, 0.4, 0.8]
  target_edge_sp:
    values: [0.9, 0.95, 0.975, 0.99, 1.1]
  target_layer_sp:
    values: [0.1, 0.4, 0.69, 0.72]
  warmup_steps:
    values: [500, 1000, 1500, 2000]
  disable_node_loss:
    values: [true, false]

command:
  - python3
  - ${program}
  - --sweep
  - --models
  - "qwen2.5"
  - --tasks
  - ioi
  - --cache_dir
  - "/nfs/gdata/llms/hf-models"
  - --output_root
  - "/nfs/gdata/pmondorf/projects/MIB-circuit-track/edge-pruning/results"
  - --max_steps
  - 3000
  - --batch_size
  - 16
  - --start_edge_sp
  - 0.00
  - --start_layer_sp
  - 0.00
  - --warmup_type
  - "linear"
  - --with_embedding_nodes
  - ${args_no_boolean_flags}